{% extends "layout.html" %}

{% block title %}登录{% endblock %}

{% block content %}
  <form method="post">
    <div class="form-group">
      <label for="username">用户名</label>
      <input type="text" class="form-control" id="username" name="username" required maxlength="16" autocomplete="username">
    </div>
    <div class="form-group">
      <label for="password">密码</label>
      <input type="password" class="form-control" id="password" name="password" required maxlength="16" autocomplete="current-password">
    </div>
    <div class="form-group">
      <button type="submit" class="btn btn-primary">登录</button>
      <span class="ml-2 text-muted">用户名和密码一样即可登录。</span>
    </div>
  </form>
{% endblock %}

{% block scripts %}
<script>
  $('form').on('submit', function () {
    var username = $('#username').val().trim();
    var password = $('#password').val().trim();

    if (username !== password) {
      return alert('用户名和密码不一致。');
    }

    $.ajax({
      url: '/api/login',
      type: 'post',
      xhrFields: {
          withCredentials: true
      },
      success: function (res) {
        console.log(res);
      },
      error: function (err) {
        console.error(err);
      }
    });

    
    return false;
  });
</script>
{% endblock %}
